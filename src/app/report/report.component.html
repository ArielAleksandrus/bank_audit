<div class="header">
	<div class="header-title">Relatório do dia <b>{{fromPtbr}}</b> <span *ngIf="toPtbr"> até <b>{{toPtbr}}</b></span></div>
	<div class="header-data">
		<div>
			<button class="btn btn-md btn-primary" (click)="selection = 'incomes'">
				Entradas: {{incomes.length}}
			</button>
		</div>
		<div>
			<button class="btn btn-md btn-primary" (click)="selection = 'purchases'">
				Saídas: {{purchases.length}}
			</button>
		</div>
		<div>
			<button class="btn btn-md btn-primary" (click)="selection = 'boletos'">
				Boletos: {{boletos.length}}
			</button>
		</div>
		<div>
			<button *ngIf="selection != 'none'" class="btn btn-md btn-danger" (click)="selection = 'none'">
				Recolher
			</button>
		</div>
		<div>
			<button *ngIf="purchases.length > 0 || incomes.length > 0" class="btn btn-md btn-success" (click)="selection = 'reports'">
				Gerar Relatório
			</button>
		</div>
	</div>
</div>

<app-tag-description *ngIf="reports && selection == 'reports'"
											[(tags)]="reports.tags"
											(onSave)="generateReport()"
											(onClose)="generateReport()"></app-tag-description>
<div *ngIf="describedReport" [class.print]="printDescribedReportTable">
	<table id="describedReportTable" class="table table-hover table-striped">
		<thead>
			<tr>
				<th colspan="2">Relatório do dia {{fromPtbr}} <span *ngIf="toPtbr"> até {{toPtbr}}</span></th>
			</tr>
		</thead>
		@for (descriptionEl of describedReport.descriptions; track descriptionEl) {
		<thead>
			<tr>
				<th>{{descriptionEl.description}}</th>
				<th>{{descriptionEl.total | currency:'BRL'}}</th>
			</tr>
		</thead>
		<tbody>
			@for (tagItem of descriptionEl.tags; track tagItem) {
				<tr>
					<td>{{tagItem.name}}</td>
					<td>{{tagItem.total | currency:'BRL'}}</td>
				</tr>
			}
		</tbody>
		}
		<tfoot>
			<tr>
				<td><b>TOTAL DESPESAS</b></td>
				<td><b>{{describedReport.total | currency:'BRL'}}</b></td>
			</tr>
		</tfoot>
	</table>
	<div class="button-container">
		<button class="btn btn-md btn-secondary" (click)="print('describedReportTable')">Imprimir</button>
	</div>
</div>

<div class="body-tables row">
	<div class="table-container col-lg-12" *ngIf="selection == 'incomes'">
		<app-income [incomes]="incomes" [collapse]="false" canSave="true" canDestroy="true"></app-income>
	</div>
	<div class="table-container col-lg-12" *ngIf="selection == 'purchases'">
		<app-purchase [purchases]="purchases" [collapse]="false" canSave="true" canDestroy="true"></app-purchase>
	</div>
	<div class="table-container col-lg-12" *ngIf="selection == 'boletos'">
		<app-boleto [boletos]="boletos" [collapse]="false" canSave="true" canDestroy="true"></app-boleto>
	</div>
</div>
<div class="charts">
	<h3>GASTOS</h3>
	<div class="row">
		<!-- Purchase tag chart -->
		<div class="col-lg-6">
			<div class="title">Todas as Compras</div>
			<app-tag-chart *ngIf="purchaseTagData" class="chart" [tagClassification]="purchaseTagData" (onSelect)="purchaseChartSelection($event)"></app-tag-chart>
		</div>
		<!-- Boleto tag chart -->
		<div class="col-lg-6">
			<div class="title">Apenas Boletos</div>
			<app-tag-chart *ngIf="boletoTagData" class="chart" [tagClassification]="boletoTagData"></app-tag-chart>
		</div>
	</div>
</div>

<div *ngIf="selectedTag" id="selection">
	<hr/>
	<app-purchase [purchases]="selectedPurchases" canSave="true" canDestroy="true"></app-purchase>
</div>

<div class="tables">
	<hr/>
	<h3>RECEITAS</h3>
	<app-income-sum *ngIf="incomeSummary" [summary]="incomeSummary"></app-income-sum>
</div>